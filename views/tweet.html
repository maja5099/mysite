% import x

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/app.css">
    <title>Document</title>

</head>
<body class="bg-black">

    <form method="POST" onsubmit="validate(tweet); return false">
        <input name="message" type="text" data-validate="str" data-min="{{x.TWEET_MIN_LEN}}" data-max="{{x.TWEET_MAX_LEN}}">
        <button class="bg-white text-black">
            Tweet
        </button>
    </form>


    <section id="tweets" class="text-white">
        % for tweet in tweets:
        <div class="tweet">
            <div>{{tweet["tweet_id"]}}</div>
            <div>{{tweet["tweet_message"]}}</div>
        </div>
        % end
    </section>





    
    <!-- what's happening start -->
    <div class="px-4 py-2">
        <div class="inline-flex w-full gap-4">

            <!-- user avatar start -->
            <div class="grid place-items-start w-1/12">
                <img src="/images/avatars/9710eebde79f4e7b9a1873b4bf1c9792.jpg" class="w-12 rounded-full" alt="">
            </div>
            <!-- user avatar end -->
            
            <!-- tweet start -->
            <div class="pt-3 w-11/12">
                <form method="POST" onsubmit="validate(tweet); return false">
                
                    <!-- text area start -->
                    <input name="message" type="text" data-validate="str" data-min="{{x.TWEET_MIN_LEN}}" data-max="{{x.TWEET_MAX_LEN}}" placeholder="What's happening?" class="text-20 bg-black text-twitter-light-grey w-full placeholder-twitter-grey bg-inherit outline-none">
                    <!-- text area end -->

                    <!-- icons start -->
                    <div class="flex items-center pt-3"> 
                        <div class="flex">
                            <!-- media start -->
                            <div class="hover:bg-twitter-blue group text-twitter-blue hover:bg-opacity-15 rounded-full hover:cursor-pointer p-2 transition duration-200 ease-in-out">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 3 5.5 C 3 4.119 4.119 3 5.5 3 h 13 C 19.881 3 21 4.119 21 5.5 v 13 c 0 1.381 -1.119 2.5 -2.5 2.5 h -13 C 4.119 21 3 19.881 3 18.5 v -13 Z M 5.5 5 c -0.276 0 -0.5 0.224 -0.5 0.5 v 9.086 l 3 -3 l 3 3 l 5 -5 l 3 3 V 5.5 c 0 -0.276 -0.224 -0.5 -0.5 -0.5 h -13 Z M 19 15.414 l -3 -3 l -5 5 l -3 -3 l -3 3 V 18.5 c 0 0.276 0.224 0.5 0.5 0.5 h 13 c 0.276 0 0.5 -0.224 0.5 -0.5 v -3.086 Z M 9.75 7 C 8.784 7 8 7.784 8 8.75 s 0.784 1.75 1.75 1.75 s 1.75 -0.784 1.75 -1.75 S 10.716 7 9.75 7 Z"/></svg>
                            </div>
                            <!-- media end -->

                            <!-- gif start -->
                            <div class="hover:bg-twitter-blue group text-twitter-blue hover:bg-opacity-15 rounded-full hover:cursor-pointer p-2 transition duration-200 ease-in-out">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 3 5.5 C 3 4.119 4.12 3 5.5 3 h 13 C 19.88 3 21 4.119 21 5.5 v 13 c 0 1.381 -1.12 2.5 -2.5 2.5 h -13 C 4.12 21 3 19.881 3 18.5 v -13 Z M 5.5 5 c -0.28 0 -0.5 0.224 -0.5 0.5 v 13 c 0 0.276 0.22 0.5 0.5 0.5 h 13 c 0.28 0 0.5 -0.224 0.5 -0.5 v -13 c 0 -0.276 -0.22 -0.5 -0.5 -0.5 h -13 Z M 18 10.711 V 9.25 h -3.74 v 5.5 h 1.44 v -1.719 h 1.7 V 11.57 h -1.7 v -0.859 H 18 Z M 11.79 9.25 h 1.44 v 5.5 h -1.44 v -5.5 Z m -3.07 1.375 c 0.34 0 0.77 0.172 1.02 0.43 l 1.03 -0.86 c -0.51 -0.601 -1.28 -0.945 -2.05 -0.945 C 7.19 9.25 6 10.453 6 12 s 1.19 2.75 2.72 2.75 c 0.85 0 1.54 -0.344 2.05 -0.945 v -2.149 H 8.38 v 1.032 H 9.4 v 0.515 c -0.17 0.086 -0.42 0.172 -0.68 0.172 c -0.76 0 -1.36 -0.602 -1.36 -1.375 c 0 -0.688 0.6 -1.375 1.36 -1.375 Z"/></svg>
                            </div>
                            <!-- gif end -->
                            
                            <!-- poll start -->
                            <div class="hover:bg-twitter-blue group text-twitter-blue hover:bg-opacity-15 rounded-full hover:cursor-pointer p-2 hidden lg:flex transition duration-200 ease-in-out">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 6 5 c -1.1 0 -2 0.895 -2 2 s 0.9 2 2 2 s 2 -0.895 2 -2 s -0.9 -2 -2 -2 Z M 2 7 c 0 -2.209 1.79 -4 4 -4 s 4 1.791 4 4 s -1.79 4 -4 4 s -4 -1.791 -4 -4 Z m 20 1 H 12 V 6 h 10 v 2 Z M 6 15 c -1.1 0 -2 0.895 -2 2 s 0.9 2 2 2 s 2 -0.895 2 -2 s -0.9 -2 -2 -2 Z m -4 2 c 0 -2.209 1.79 -4 4 -4 s 4 1.791 4 4 s -1.79 4 -4 4 s -4 -1.791 -4 -4 Z m 20 1 H 12 v -2 h 10 v 2 Z M 7 7 c 0 0.552 -0.45 1 -1 1 s -1 -0.448 -1 -1 s 0.45 -1 1 -1 s 1 0.448 1 1 Z"/></svg>
                            </div>
                            <!-- poll end -->

                            <!-- emoji start -->
                            <div class="hover:bg-twitter-blue group text-twitter-blue hover:bg-opacity-15 rounded-full hover:cursor-pointer p-2 transition duration-200 ease-in-out">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 8 9.5 C 8 8.119 8.672 7 9.5 7 S 11 8.119 11 9.5 S 10.328 12 9.5 12 S 8 10.881 8 9.5 Z m 6.5 2.5 c 0.828 0 1.5 -1.119 1.5 -2.5 S 15.328 7 14.5 7 S 13 8.119 13 9.5 s 0.672 2.5 1.5 2.5 Z M 12 16 c -2.224 0 -3.021 -2.227 -3.051 -2.316 l -1.897 0.633 c 0.05 0.15 1.271 3.684 4.949 3.684 s 4.898 -3.533 4.949 -3.684 l -1.896 -0.638 c -0.033 0.095 -0.83 2.322 -3.053 2.322 Z m 10.25 -4.001 c 0 5.652 -4.598 10.25 -10.25 10.25 S 1.75 17.652 1.75 12 S 6.348 1.75 12 1.75 S 22.25 6.348 22.25 12 Z m -2 0 c 0 -4.549 -3.701 -8.25 -8.25 -8.25 S 3.75 7.451 3.75 12 s 3.701 8.25 8.25 8.25 s 8.25 -3.701 8.25 -8.25 Z"/></svg>
                            </div>
                            <!-- emoji end -->

                            <!-- schedule start -->
                            <div class="hover:bg-twitter-blue group text-twitter-blue hover:bg-opacity-15 rounded-full hover:cursor-pointer p-2 hidden lg:flex transition duration-200 ease-in-out">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 6 3 V 2 h 2 v 1 h 6 V 2 h 2 v 1 h 1.5 C 18.88 3 20 4.119 20 5.5 v 2 h -2 v -2 c 0 -0.276 -0.22 -0.5 -0.5 -0.5 H 16 v 1 h -2 V 5 H 8 v 1 H 6 V 5 H 4.5 c -0.28 0 -0.5 0.224 -0.5 0.5 v 12 c 0 0.276 0.22 0.5 0.5 0.5 h 3 v 2 h -3 C 3.12 20 2 18.881 2 17.5 v -12 C 2 4.119 3.12 3 4.5 3 H 6 Z m 9.5 8 c -2.49 0 -4.5 2.015 -4.5 4.5 s 2.01 4.5 4.5 4.5 s 4.5 -2.015 4.5 -4.5 s -2.01 -4.5 -4.5 -4.5 Z M 9 15.5 C 9 11.91 11.91 9 15.5 9 s 6.5 2.91 6.5 6.5 s -2.91 6.5 -6.5 6.5 S 9 19.09 9 15.5 Z m 5.5 -2.5 h 2 v 2.086 l 1.71 1.707 l -1.42 1.414 l -2.29 -2.293 V 13 Z"/></svg>
                            </div>
                            <!-- schedule end -->

                            <!-- location start -->
                            <div class="hover:bg-twitter-blue group text-twitter-blue opacity-50 hover:bg-opacity-15 rounded-full hover:cursor-pointer p-2 transition duration-200 ease-in-out">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" stroke="" stroke-linecap="round" stroke-linejoin="round" d="M 12 7 c -1.93 0 -3.5 1.57 -3.5 3.5 S 10.07 14 12 14 s 3.5 -1.57 3.5 -3.5 S 13.93 7 12 7 Z m 0 5 c -0.827 0 -1.5 -0.673 -1.5 -1.5 S 11.173 9 12 9 s 1.5 0.673 1.5 1.5 S 12.827 12 12 12 Z m 0 -10 c -4.687 0 -8.5 3.813 -8.5 8.5 c 0 5.967 7.621 11.116 7.945 11.332 l 0.555 0.37 l 0.555 -0.37 c 0.324 -0.216 7.945 -5.365 7.945 -11.332 C 20.5 5.813 16.687 2 12 2 Z m 0 17.77 c -1.665 -1.241 -6.5 -5.196 -6.5 -9.27 C 5.5 6.916 8.416 4 12 4 s 6.5 2.916 6.5 6.5 c 0 4.073 -4.835 8.028 -6.5 9.27 Z"/></svg>
                            </div>
                            <!-- location end -->                    
                        </div>
                        <!-- icons end -->
                        
                        <!-- button start -->
                        <button id="button" class="text-15 font-bold px-4 py-1.5 rounded-full ml-auto text-twitter-light-grey bg-twitter-blue">
                            Tweet
                        </button>          
                        <!-- button end -->
                    </div>
                </form>
            </div>
            <!-- tweet end -->
        </div>
    </div>
    <!-- what's happening end -->





    <script src="/js/validate.js"></script>

    <script>
        async function tweet(){
            const frm = event.target // The form
            const conn = await fetch("/tweet", {
                method: "POST",
                body: new FormData(frm)
            })
            // const data = await conn.text()  // To get plain text
            const data = await conn.json()
            console.log(data)
            const message = frm.querySelector("input[name='message']").value
            console.log(message)
            document.querySelector("#tweets").insertAdjacentHTML("afterbegin", 
            `
            <div class="tweet">
                <div>${data.tweet_id}</div>
                <div>${message}</div>
            </div>
            `
            )
        }
    </script>

</body>
</html>